<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="类相关获取isa指向的ClassClass object_getClass(id obj);&#x2F;&#x2F;其本质是获取isa指针所指向的数据   方法实现： Class object_getClass(id obj) &amp;#123;  if (obj) return obj-&gt;getIsa();  else return nil;&amp;#125;  示例： &#x2F;**    object_getClass(id">
<meta property="og:type" content="article">
<meta property="og:title" content="Runtime常用API总结">
<meta property="og:url" content="http://yoursite.com/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Dev.Gao的学习笔记">
<meta property="og:description" content="类相关获取isa指向的ClassClass object_getClass(id obj);&#x2F;&#x2F;其本质是获取isa指针所指向的数据   方法实现： Class object_getClass(id obj) &amp;#123;  if (obj) return obj-&gt;getIsa();  else return nil;&amp;#125;  示例： &#x2F;**    object_getClass(id">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/before_exchange.png">
<meta property="og:image" content="http://yoursite.com/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/after_exchange.png">
<meta property="article:published_time" content="2017-05-29T22:41:05.000Z">
<meta property="article:author" content="Dev.Gao">
<meta property="article:tag" content="iOS,Android,Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/before_exchange.png">

<link rel="canonical" href="http://yoursite.com/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Runtime常用API总结 | Dev.Gao的学习笔记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Dev.Gao的学习笔记</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录成长</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dev.Gao">
      <meta itemprop="description" content="人类的本能是胆怯，但人类的本质是不甘心">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dev.Gao的学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Runtime常用API总结
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-05-30 06:41:05" itemprop="dateCreated datePublished" datetime="2017-05-30T06:41:05+08:00">2017-05-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/Objective-C/" itemprop="url" rel="index"><span itemprop="name">Objective-C</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="类相关"><a href="#类相关" class="headerlink" title="类相关"></a>类相关</h2><h3 id="获取isa指向的Class"><a href="#获取isa指向的Class" class="headerlink" title="获取isa指向的Class"></a>获取isa指向的Class</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">Class object_getClass(<span class="keyword">id</span> obj);<span class="comment">//其本质是获取isa指针所指向的数据</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>方法实现：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">Class object_getClass(<span class="keyword">id</span> obj) </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (obj) <span class="keyword">return</span> obj-&gt;getIsa();</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    object_getClass(id obj);其本质是获取isa指针所指向的数据</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">GLStudent *stu = [[GLStudent alloc] init];</span><br><span class="line">Class cls = object_getClass(stu); <span class="comment">//获取的是 GLStudent</span></span><br><span class="line">Class metaCls = object_getClass(cls); <span class="comment">//获取的是GLStudent的元类</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="设置isa指向的Class"><a href="#设置isa指向的Class" class="headerlink" title="设置isa指向的Class"></a>设置isa指向的Class</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">Class object_setClass(<span class="keyword">id</span> obj, Class cls);<span class="comment">//其方法本质就是改变ISA的指向</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>方法实现：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">Class object_setClass(<span class="keyword">id</span> obj, Class cls)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!obj) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> (!cls-&gt;isFuture()  &amp;&amp;  !cls-&gt;isInitialized()) &#123;</span><br><span class="line">        _class_initialize(_class_getNonMetaClass(cls, <span class="literal">nil</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> obj-&gt;changeIsa(cls);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">GLPerson</span></span></span><br><span class="line">- (<span class="keyword">void</span>)run &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;Person is runing&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">GLCar</span></span></span><br><span class="line">- (<span class="keyword">void</span>)run &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;Car is running&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">GLPerson *person = [[GLPerson alloc] init];</span><br><span class="line">[person run]; <span class="comment">//Person is runing</span></span><br><span class="line">        </span><br><span class="line">object_setClass(person, [GLCar <span class="keyword">class</span>]);</span><br><span class="line">[person run]; <span class="comment">//Car is running</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="判断一个OC对象是否为Class"><a href="#判断一个OC对象是否为Class" class="headerlink" title="判断一个OC对象是否为Class"></a>判断一个OC对象是否为Class</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> object_isClass(<span class="keyword">id</span> obj);</span><br><span class="line"><span class="comment">//该方法的本质是判断obj的ISA指向的对象是否是metaClass</span></span><br><span class="line"><span class="comment">// 而判断是否是metaClass的依据是: class_ro_t中的flags</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>方法实现</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">object_isClass</span><span class="params">(id obj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!obj) <span class="keyword">return</span> NO;</span><br><span class="line">    <span class="keyword">return</span> obj-&gt;isClass();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">objc_object::isClass</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isTaggedPointer()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> ISA()-&gt;isMetaClass();<span class="comment">//判断该对象的ISA指向的对象是否是mateClass</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> :</span> objc_object &#123; </span><br><span class="line">  <span class="function"><span class="keyword">bool</span> <span class="title">isMetaClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data()-&gt;ro-&gt;flags &amp; RO_META; <span class="comment">//是否是mateClass判断的依据</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="判断一个Class是否为元类"><a href="#判断一个Class是否为元类" class="headerlink" title="判断一个Class是否为元类"></a>判断一个Class是否为元类</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> class_isMetaClass(Class cls);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>方法实现</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//同上，判断cls是否是元类对象，即判断ro里的flags</span></span><br><span class="line"><span class="function">BOOL <span class="title">class_isMetaClass</span><span class="params">(Class cls)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!cls) <span class="keyword">return</span> NO;</span><br><span class="line">    <span class="keyword">return</span> cls-&gt;isMetaClass();</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> :</span> objc_object &#123; </span><br><span class="line">  <span class="function"><span class="keyword">bool</span> <span class="title">isMetaClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data()-&gt;ro-&gt;flags &amp; RO_META; <span class="comment">//是否是mateClass判断的依据</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="动态创建、注册、销毁一个类"><a href="#动态创建、注册、销毁一个类" class="headerlink" title="动态创建、注册、销毁一个类"></a>动态创建、注册、销毁一个类</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 动态创建一个类（参数：父类，类名，额外的内存空间）</span></span><br><span class="line">Class objc_allocateClassPair(Class superclass, <span class="keyword">const</span> <span class="keyword">char</span> *name, size_t extraBytes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//注册一个类（要在类注册之前添加成员变量）</span></span><br><span class="line"><span class="keyword">void</span> objc_registerClassPair(Class cls);</span><br><span class="line"></span><br><span class="line"><span class="comment">//销毁一个类</span></span><br><span class="line"><span class="keyword">void</span> objc_disposeClassPair(Class cls);</span><br></pre></td></tr></table></figure>

<p><code>OC</code>允许动态注册一个类(指定父类和类名)，Runtime API还可以为这个动态创建的类添加方法、成员变量（需要在注册类之前添加）、属性、协议等等。动态创建类后，需要调用函数注册该类，这样才可以使用。</p>
<p><strong>示例：</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// 创建一个类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建一对类，会将这个类以及这个的元类创建出来</span></span><br><span class="line"><span class="comment"> * 第一个参数：[NSObject class]，指定父类</span></span><br><span class="line"><span class="comment"> * 第二个参数：类名，C语言字符串</span></span><br><span class="line"><span class="comment"> * 第三个参数：额外的存储空间，通常为0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Class GLDogCls = objc_allocateClassPair([<span class="built_in">NSObject</span> <span class="keyword">class</span>], <span class="string">&quot;GLDog&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line"><span class="comment">/// 添加成员变量</span></span><br><span class="line"><span class="comment">/// class_addIvar方法只能在 objc_allocateClassPair 之后和 objc_registerClassPair之前调用</span></span><br><span class="line"><span class="comment">/// Ivar在底层类结构中，存储在class_ro_t中，是只读的。</span></span><br><span class="line"><span class="comment">/// 新注册的类(objc_allocateClassPair)，还没有存储到class_ro_t中，</span></span><br><span class="line"><span class="comment">/// objc_registerClassPair 注册之后，class_ro_t数据成形，就不可添加了。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加一个 int 类型的 age 变量</span></span><br><span class="line"><span class="comment"> * 第一个参数：要添加成员变量的类，不能是元类字符串</span></span><br><span class="line"><span class="comment"> * 第二个参数：成员变量的名称，C语言字符串</span></span><br><span class="line"><span class="comment"> * 第三个参数：成员变量的大小</span></span><br><span class="line"><span class="comment"> * 第四个参数：alignment 内存对齐，通常使用 log2(sizeof(point-type)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">BOOL</span> isSuccessAddForAge = class_addIvar(GLDogCls, <span class="string">&quot;_age&quot;</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>), log2(<span class="keyword">sizeof</span>(<span class="keyword">int</span>)), <span class="keyword">@encode</span>(<span class="keyword">int</span>));</span><br><span class="line"><span class="built_in">BOOL</span> isSuccessAddForName = class_addIvar(GLDogCls, <span class="string">&quot;_name&quot;</span>, <span class="keyword">sizeof</span>(<span class="built_in">NSString</span> *), log2(<span class="keyword">sizeof</span>(<span class="built_in">NSString</span> *)), <span class="keyword">@encode</span>(<span class="built_in">NSString</span> *));</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;%d,%d&quot;</span>,isSuccessAddForAge,isSuccessAddForName);<span class="comment">// 1,1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// 添加方法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> printInfo(<span class="keyword">id</span> <span class="keyword">self</span>,SEL _cmd) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;my name is %@, and I am %@ years old&quot;</span>,</span><br><span class="line">          [<span class="keyword">self</span> valueForKey:<span class="string">@&quot;name&quot;</span>],</span><br><span class="line">          [<span class="keyword">self</span> valueForKey:<span class="string">@&quot;age&quot;</span>]</span><br><span class="line">          );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class_addMethod(GLDogCls, <span class="keyword">@selector</span>(printInfo), (IMP)printInfo, <span class="string">&quot;v@:&quot;</span>);</span><br><span class="line">        </span><br><span class="line"><span class="comment">/// 注册类</span></span><br><span class="line">objc_registerClassPair(GLDogCls);</span><br><span class="line">        </span><br><span class="line"><span class="comment">/// 创建实例，以及属性赋值</span></span><br><span class="line"><span class="keyword">id</span> dogInstance = [[GLDogCls alloc] init];</span><br><span class="line">[dogInstance setValue:@<span class="number">2</span> forKey:<span class="string">@&quot;age&quot;</span>];</span><br><span class="line">[dogInstance setValue:<span class="string">@&quot;Luck&quot;</span> forKey:<span class="string">@&quot;name&quot;</span>];</span><br><span class="line">        </span><br><span class="line"><span class="comment">//调用方法</span></span><br><span class="line">[dogInstance performSelector:<span class="keyword">@selector</span>(printInfo)];<span class="comment">//my name is Luck, and I am 2 years old</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// 当某个类确定不再使用时，可以使用 objc_disposeClassPair 释放该类</span></span><br><span class="line">objc_disposeClassPair(GLDogCls);</span><br></pre></td></tr></table></figure>

<h2 id="成员变量相关"><a href="#成员变量相关" class="headerlink" title="成员变量相关"></a>成员变量相关</h2><h3 id="获取类中某个成员变量的信息"><a href="#获取类中某个成员变量的信息" class="headerlink" title="获取类中某个成员变量的信息"></a>获取类中某个成员变量的信息</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//获取类中某个成员变量的信息</span></span><br><span class="line">Ivar class_getInstanceVariable(Class cls, <span class="keyword">const</span> <span class="keyword">char</span> *name);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取成员变量的相关信息</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *ivar_getName(Ivar v);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *ivar_getTypeEncoding(Ivar v);</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">GLPerson</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="keyword">int</span> age;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取类中某个成员变量的信息</span></span><br><span class="line">Ivar nameIvar = class_getInstanceVariable([GLPerson <span class="keyword">class</span>], <span class="string">&quot;_name&quot;</span>);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;%s %s&quot;</span>,ivar_getName(nameIvar),ivar_getTypeEncoding(nameIvar)); <span class="comment">//_name @&quot;NSString&quot;</span></span><br><span class="line"></span><br><span class="line">Ivar ageIvar = class_getInstanceVariable([GLPerson <span class="keyword">class</span>], <span class="string">&quot;_age&quot;</span>);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;%s %s&quot;</span>,ivar_getName(ageIvar),ivar_getTypeEncoding(ageIvar)); <span class="comment">//_age i</span></span><br></pre></td></tr></table></figure>

<h3 id="设置和获取成员变量的值"><a href="#设置和获取成员变量的值" class="headerlink" title="设置和获取成员变量的值"></a>设置和获取成员变量的值</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 设置成员变量的值</span></span><br><span class="line"><span class="keyword">void</span> object_setIvar(<span class="keyword">id</span> obj, Ivar ivar, <span class="keyword">id</span> value);</span><br><span class="line"><span class="comment">// 获取成员变量的值</span></span><br><span class="line"><span class="keyword">id</span> object_getIvar(<span class="keyword">id</span> obj, Ivar ivar);</span><br></pre></td></tr></table></figure>

<p><strong>示例：</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// 设置和获取成员变量的值</span></span><br><span class="line">GLPerson *person =  [[GLPerson alloc] init];</span><br><span class="line"><span class="comment">// 设置name的值，不走setter方法</span></span><br><span class="line">object_setIvar(person, nameIvar, <span class="string">@&quot;小李&quot;</span>);</span><br><span class="line"><span class="comment">// 获取name的值，不走getter方法</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;%@&quot;</span>,object_getIvar(person, nameIvar)); <span class="comment">//小李</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/// 基本数据类型写法稍有不同</span></span><br><span class="line"><span class="comment">// 设置age的值</span></span><br><span class="line">object_setIvar(person, ageIvar, (__bridge <span class="keyword">id</span>)(<span class="keyword">void</span> *)<span class="number">10</span>);</span><br><span class="line"><span class="comment">// 获取age的值</span></span><br><span class="line"><span class="keyword">void</span> * ageValue = (__bridge <span class="keyword">void</span> *)(object_getIvar(person, ageIvar));</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;%d&quot;</span>, (<span class="keyword">int</span>)ageValue);<span class="comment">//10</span></span><br></pre></td></tr></table></figure>

<h3 id="拷贝实例变量列表"><a href="#拷贝实例变量列表" class="headerlink" title="拷贝实例变量列表"></a>拷贝实例变量列表</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//拷贝实例变量列表(最后需要调用free释放)</span></span><br><span class="line">Ivar *class_copyIvarList(Class cls, <span class="keyword">unsigned</span> <span class="keyword">int</span> *outCount);</span><br></pre></td></tr></table></figure>

<p><strong>示例：</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// 拷贝实例变量列表(最后需要调用free释放)</span></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> ivarCount;</span><br><span class="line">Ivar *ivarList = class_copyIvarList([GLPerson <span class="keyword">class</span>], &amp;ivarCount);</span><br><span class="line">        </span><br><span class="line"><span class="comment">//遍历实例变量列表</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ivarCount; i++) &#123;</span><br><span class="line">  Ivar ivar = ivarList[i];</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@&quot;%s %s&quot;</span>,ivar_getName(ivar),ivar_getTypeEncoding(ivar));</span><br><span class="line">&#125;</span><br><span class="line">free(ivarList);</span><br></pre></td></tr></table></figure>

<h2 id="方法相关"><a href="#方法相关" class="headerlink" title="方法相关"></a>方法相关</h2><h3 id="获取一个实例方法、类方法"><a href="#获取一个实例方法、类方法" class="headerlink" title="获取一个实例方法、类方法"></a>获取一个实例方法、类方法</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取实例方法</span></span><br><span class="line">Method class_getInstanceMethod(Class cls, SEL name)</span><br><span class="line"><span class="comment">// 获取类方法</span></span><br><span class="line">Method class_getClassMethod(Class cls, SEL name)</span><br></pre></td></tr></table></figure>

<h3 id="获取方法的相关信息"><a href="#获取方法的相关信息" class="headerlink" title="获取方法的相关信息"></a>获取方法的相关信息</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 带有copy的需要调用free去释放</span></span><br><span class="line">SEL method_getName(Method m);</span><br><span class="line"></span><br><span class="line">IMP method_getImplementation(Method m);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *method_getTypeEncoding(Method m);</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> method_getNumberOfArguments(Method m);</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> *method_copyReturnType(Method m);</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> *method_copyArgumentType(Method m, <span class="keyword">unsigned</span> <span class="keyword">int</span> index);</span><br></pre></td></tr></table></figure>

<h3 id="拷贝方法列表"><a href="#拷贝方法列表" class="headerlink" title="拷贝方法列表"></a>拷贝方法列表</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 最后需要调用free释放</span></span><br><span class="line">Method *class_copyMethodList(Class cls, <span class="keyword">unsigned</span> <span class="keyword">int</span> *outCount);</span><br></pre></td></tr></table></figure>

<h3 id="动态添加方法"><a href="#动态添加方法" class="headerlink" title="动态添加方法"></a>动态添加方法</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> class_addMethod(Class cls, SEL name, IMP imp, <span class="keyword">const</span> <span class="keyword">char</span> *types);</span><br></pre></td></tr></table></figure>

<h3 id="动态替换方法"><a href="#动态替换方法" class="headerlink" title="动态替换方法"></a>动态替换方法</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">IMP class_replaceMethod(Class cls, SEL name, IMP imp, <span class="keyword">const</span> <span class="keyword">char</span> *types);</span><br></pre></td></tr></table></figure>

<p><strong>示例：</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">GLPerson</span> : <span class="title">NSObject</span></span></span><br><span class="line">- (<span class="keyword">void</span>) run;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">GLPerson</span></span></span><br><span class="line">- (<span class="keyword">void</span>) run &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;%s&quot;</span>,__func__);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">  </span><br><span class="line">GLPerson *person = [[GLPerson alloc] init];</span><br><span class="line">[person run];   <span class="comment">//-[GLPerson run]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用C语言函数替换实现</span></span><br><span class="line"><span class="keyword">void</span> myrun(<span class="keyword">id</span> <span class="keyword">self</span>,SEL _cmd) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;myrun&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">class_replaceMethod([GLPerson <span class="keyword">class</span>], <span class="keyword">@selector</span>(run), (IMP)myrun, <span class="string">&quot;v@:&quot;</span>);</span><br><span class="line">[person run];   <span class="comment">//myrun</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//也可使用block替换实现</span></span><br><span class="line">class_replaceMethod([GLPerson <span class="keyword">class</span>], <span class="keyword">@selector</span>(run), imp_implementationWithBlock(^(<span class="keyword">id</span> <span class="keyword">self</span>,SEL _cmd)&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@&quot;self is %@&quot;</span>,<span class="keyword">self</span>);</span><br><span class="line">&#125;), <span class="string">&quot;v@:&quot;</span>);</span><br><span class="line">[person run]; <span class="comment">//self is &lt;GLPerson: 0x1007b85f0&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="方法操作相关"><a href="#方法操作相关" class="headerlink" title="方法操作相关"></a>方法操作相关</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取cls中,sel的实现</span></span><br><span class="line">IMP class_getMethodImplementation(Class cls, SEL name);</span><br><span class="line"><span class="comment">//设置方法新的实现</span></span><br><span class="line">IMP method_setImplementation(Method m, IMP imp);</span><br><span class="line"><span class="comment">//交换两个方法实现</span></span><br><span class="line"><span class="keyword">void</span> method_exchangeImplementations(Method m1, Method m2); </span><br></pre></td></tr></table></figure>

<p>其中<code>method_exchangeImplementations()</code>交换两个方法实现在iOS框架中应用的很广。比如：</p>
<h4 id="示例1，UIButton事件点击全埋点"><a href="#示例1，UIButton事件点击全埋点" class="headerlink" title="示例1，UIButton事件点击全埋点"></a>示例1，<code>UIButton</code>事件点击全埋点</h4><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIControl</span> (<span class="title">Extension</span>)</span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    Method oldMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(sendAction:to:forEvent:));</span><br><span class="line">    Method newMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(gl_sendAction:to:forEvent:));</span><br><span class="line">    method_exchangeImplementations(oldMethod, newMethod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)gl_sendAction:(SEL)action to:(<span class="keyword">id</span>)target forEvent:(<span class="built_in">UIEvent</span> *)event &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//如果是按钮</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span> isKindOfClass:[<span class="built_in">UIButton</span> <span class="keyword">class</span>]]) &#123;</span><br><span class="line">        <span class="comment">//其他处理，埋点</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;action=%@,target=%@&quot;</span>,<span class="built_in">NSStringFromSelector</span>(action),target);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//调用系统原有的实现</span></span><br><span class="line">    [<span class="keyword">self</span> gl_sendAction:action to:target forEvent:event];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>UIButton</code>继承自<code>UIControl</code>，通过<code>addTarget-Selector</code>添加点击事件后，都会来到<code>sendAction:to:forEvent:</code>方法。所以可以通过方法交换的方式来达到<strong>hook</strong>的方式。</p>
<p>示例中，还有一个点，调用系统原有实现时，调用了<code>gl_sendAction:to:forEvent:</code>。字面上看造成了死循环其实不然，我们通过下面的图来解释。</p>
<p><strong>方法没有交换前</strong></p>
<p><code>@selector(sendAction:to:forEvent:)</code>可以找到<code>sendAction:to:forEvent:</code>的实现。</p>
<p><code>@selector(gl_sendAction:to:forEvent:)</code>可以找到<code>gl_sendAction:to:forEvent:</code>的实现。</p>
<img src="/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/before_exchange.png" class="">

<p><strong>实现交换后</strong></p>
<img src="/2017/05/30/Runtime%E5%B8%B8%E7%94%A8API%E6%80%BB%E7%BB%93/after_exchange.png" class="">

<p>**所以系统内部调用<code>sendAction:to:forEvent:</code>时，会来到<code>gl_sendAction:to:forEvent:</code>的实现。当我们调用系统原有的实现就要调用<code>gl_sendAction:to:forEvent:</code>**。</p>
<h4 id="示例2，NSArray防止崩溃"><a href="#示例2，NSArray防止崩溃" class="headerlink" title="示例2，NSArray防止崩溃"></a>示例2，NSArray防止崩溃</h4><p>我们都知道数组是不可以添加<code>nil</code>的，否则会发生崩溃</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSMutableArray</span> *array = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line"><span class="built_in">NSObject</span> *obj = <span class="literal">nil</span>;</span><br><span class="line">[array addObject:obj];</span><br></pre></td></tr></table></figure>

<p>crash信息：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">*** Terminating app due to uncaught exception <span class="string">&#x27;NSInvalidArgumentException&#x27;</span>, reason: <span class="string">&#x27;*** -[__NSArrayM insertObject:atIndex:]: object cannot be nil&#x27;</span></span><br></pre></td></tr></table></figure>

<p>从这我们可以看出，<code>addObjcect:</code>方法最后调用了<code>insertObject:atIndex:</code>。NSMutableArray的类并不是我们看到的NSMutableArray,而是__NSArrayM 。这是因为<code>Foundation framewor</code>k框架下广泛使用了<strong>类簇</strong>的设计模式。它管理了一组隐藏在公共抽象父类下的具体私有子类。</p>
<p>在Cocoa中，实际上许多类都是以类簇的方式实现的，即它们是一群隐藏在通用接口之下与实现相关的类。例如创建数组时可能是<code>__NSArray0</code>,<code>__NSSingleObjectArray</code>, <code>__NSArrayI</code>，所以请不要轻易尝试创建<code>NSString</code>，<code>NSArray</code>,<code>NSDictionary</code>的子类。对类簇使用<code>isKindOfClass</code>和<code>isMemberOfClass</code>的结果可能是不正确的。因为类簇是由公共抽象类管理的一组私有类，公共抽象类并不是实例对应的真正的类，类簇中真正的类的从属关系被隐藏了。</p>
<p>所以要对<code>NSMutableArray</code>操作，选择的类是<code>__NSArrayM</code></p>
<p>这里要对<code>insertObject:atIndex:</code>添加非空判断。</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSMutableArray</span> (<span class="title">Extension</span>)</span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    Class cls = <span class="built_in">NSClassFromString</span>(<span class="string">@&quot;__NSArrayM&quot;</span>);</span><br><span class="line">    Method old = class_getInstanceMethod(cls, <span class="keyword">@selector</span>(insertObject:atIndex:));</span><br><span class="line">    Method new = class_getInstanceMethod(cls, <span class="keyword">@selector</span>(gl_insertObject:atIndex:));</span><br><span class="line">    method_exchangeImplementations(old, new);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)gl_insertObject:(<span class="keyword">id</span>)anObject atIndex:(<span class="built_in">NSUInteger</span>)index &#123;</span><br><span class="line">    <span class="keyword">if</span> (!anObject) <span class="keyword">return</span>;</span><br><span class="line">    [<span class="keyword">self</span> gl_insertObject:anObject atIndex:index];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="选择器相关"><a href="#选择器相关" class="headerlink" title="选择器相关"></a>选择器相关</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *sel_getName(SEL sel)</span><br><span class="line">SEL sel_registerName(<span class="keyword">const</span> <span class="keyword">char</span> *str)</span><br></pre></td></tr></table></figure>

<h3 id="用block作为方法实现"><a href="#用block作为方法实现" class="headerlink" title="用block作为方法实现"></a>用block作为方法实现</h3><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">IMP imp_implementationWithBlock(<span class="keyword">id</span> block);</span><br><span class="line"><span class="keyword">id</span> imp_getBlock(IMP anImp);</span><br><span class="line"><span class="built_in">BOOL</span> imp_removeBlock(IMP anImp);</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/05/12/Super%E6%8E%A2%E7%A9%B6/" rel="prev" title="Super探究">
      <i class="fa fa-chevron-left"></i> Super探究
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/06/15/Runloop%E6%8E%A2%E7%A9%B6/" rel="next" title="RunLoop探究">
      RunLoop探究 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E7%9B%B8%E5%85%B3"><span class="nav-number">1.</span> <span class="nav-text">类相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96isa%E6%8C%87%E5%90%91%E7%9A%84Class"><span class="nav-number">1.1.</span> <span class="nav-text">获取isa指向的Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEisa%E6%8C%87%E5%90%91%E7%9A%84Class"><span class="nav-number">1.2.</span> <span class="nav-text">设置isa指向的Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AAOC%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E4%B8%BAClass"><span class="nav-number">1.3.</span> <span class="nav-text">判断一个OC对象是否为Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AAClass%E6%98%AF%E5%90%A6%E4%B8%BA%E5%85%83%E7%B1%BB"><span class="nav-number">1.4.</span> <span class="nav-text">判断一个Class是否为元类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%88%9B%E5%BB%BA%E3%80%81%E6%B3%A8%E5%86%8C%E3%80%81%E9%94%80%E6%AF%81%E4%B8%80%E4%B8%AA%E7%B1%BB"><span class="nav-number">1.5.</span> <span class="nav-text">动态创建、注册、销毁一个类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E7%9B%B8%E5%85%B3"><span class="nav-number">2.</span> <span class="nav-text">成员变量相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%B1%BB%E4%B8%AD%E6%9F%90%E4%B8%AA%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="nav-number">2.1.</span> <span class="nav-text">获取类中某个成员变量的信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%92%8C%E8%8E%B7%E5%8F%96%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E7%9A%84%E5%80%BC"><span class="nav-number">2.2.</span> <span class="nav-text">设置和获取成员变量的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F%E5%88%97%E8%A1%A8"><span class="nav-number">2.3.</span> <span class="nav-text">拷贝实例变量列表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E7%9B%B8%E5%85%B3"><span class="nav-number">3.</span> <span class="nav-text">方法相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E3%80%81%E7%B1%BB%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.</span> <span class="nav-text">获取一个实例方法、类方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%96%B9%E6%B3%95%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF"><span class="nav-number">3.2.</span> <span class="nav-text">获取方法的相关信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D%E6%96%B9%E6%B3%95%E5%88%97%E8%A1%A8"><span class="nav-number">3.3.</span> <span class="nav-text">拷贝方法列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%B7%BB%E5%8A%A0%E6%96%B9%E6%B3%95"><span class="nav-number">3.4.</span> <span class="nav-text">动态添加方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E6%9B%BF%E6%8D%A2%E6%96%B9%E6%B3%95"><span class="nav-number">3.5.</span> <span class="nav-text">动态替换方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E6%93%8D%E4%BD%9C%E7%9B%B8%E5%85%B3"><span class="nav-number">3.6.</span> <span class="nav-text">方法操作相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B1%EF%BC%8CUIButton%E4%BA%8B%E4%BB%B6%E7%82%B9%E5%87%BB%E5%85%A8%E5%9F%8B%E7%82%B9"><span class="nav-number">3.6.1.</span> <span class="nav-text">示例1，UIButton事件点击全埋点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B2%EF%BC%8CNSArray%E9%98%B2%E6%AD%A2%E5%B4%A9%E6%BA%83"><span class="nav-number">3.6.2.</span> <span class="nav-text">示例2，NSArray防止崩溃</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E5%99%A8%E7%9B%B8%E5%85%B3"><span class="nav-number">3.7.</span> <span class="nav-text">选择器相关</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8block%E4%BD%9C%E4%B8%BA%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0"><span class="nav-number">3.8.</span> <span class="nav-text">用block作为方法实现</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dev.Gao</p>
  <div class="site-description" itemprop="description">人类的本能是胆怯，但人类的本质是不甘心</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dev.Gao</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
