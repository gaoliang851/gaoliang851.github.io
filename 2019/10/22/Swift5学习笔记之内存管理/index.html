<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="æ¦‚è¿° è·ŸOCä¸€æ ·ï¼ŒSwfitä¹Ÿæ˜¯é‡‡å–åŸºäºå¼•ç”¨è®¡æ•°çš„ARCå†…å­˜ç®¡ç†æ–¹æ¡ˆ(é’ˆå¯¹å †ç©ºé—´) Swfitçš„ARCä¸­æœ‰3ç§å¼•ç”¨ å¼ºå¼•ç”¨(strong reference): é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼•ç”¨éƒ½æ˜¯å¼ºå¼•ç”¨ å¼±å¼•ç”¨(weak refierence): é€šè¿‡weakå®šä¹‰å¼±å¼•ç”¨ å¼±å¼•ç”¨å¿…é¡»æ˜¯å¯é€‰ç±»å‹çš„varï¼Œå› ä¸ºå®ä¾‹é”€æ¯åï¼ŒARCä¼šè‡ªåŠ¨å°†å¼±å¼•ç”¨è®¾ç½®ä¸ºnil ARCè‡ªåŠ¨ç»™å¼±å¼•ç”¨è®¾ç½®nilæ—¶ï¼Œä¸ä¼šè§¦å‘å±æ€§è§‚å¯Ÿå™¨   æ— ä¸»å¼•">
<meta property="og:type" content="article">
<meta property="og:title" content="Swift5å­¦ä¹ ç¬”è®°ä¹‹å†…å­˜ç®¡ç†">
<meta property="og:url" content="http://yoursite.com/2019/10/22/Swift5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="Dev.Gaoçš„å­¦ä¹ ç¬”è®°">
<meta property="og:description" content="æ¦‚è¿° è·ŸOCä¸€æ ·ï¼ŒSwfitä¹Ÿæ˜¯é‡‡å–åŸºäºå¼•ç”¨è®¡æ•°çš„ARCå†…å­˜ç®¡ç†æ–¹æ¡ˆ(é’ˆå¯¹å †ç©ºé—´) Swfitçš„ARCä¸­æœ‰3ç§å¼•ç”¨ å¼ºå¼•ç”¨(strong reference): é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼•ç”¨éƒ½æ˜¯å¼ºå¼•ç”¨ å¼±å¼•ç”¨(weak refierence): é€šè¿‡weakå®šä¹‰å¼±å¼•ç”¨ å¼±å¼•ç”¨å¿…é¡»æ˜¯å¯é€‰ç±»å‹çš„varï¼Œå› ä¸ºå®ä¾‹é”€æ¯åï¼ŒARCä¼šè‡ªåŠ¨å°†å¼±å¼•ç”¨è®¾ç½®ä¸ºnil ARCè‡ªåŠ¨ç»™å¼±å¼•ç”¨è®¾ç½®nilæ—¶ï¼Œä¸ä¼šè§¦å‘å±æ€§è§‚å¯Ÿå™¨   æ— ä¸»å¼•">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-10-22T03:04:06.000Z">
<meta property="article:author" content="Dev.Gao">
<meta property="article:tag" content="Swift">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2019/10/22/Swift5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Swift5å­¦ä¹ ç¬”è®°ä¹‹å†…å­˜ç®¡ç† | Dev.Gaoçš„å­¦ä¹ ç¬”è®°</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Dev.Gaoçš„å­¦ä¹ ç¬”è®°</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">è®°å½•æˆé•¿</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/22/Swift5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dev.Gao">
      <meta itemprop="description" content="äººç±»çš„æœ¬èƒ½æ˜¯èƒ†æ€¯ï¼Œä½†äººç±»çš„æœ¬è´¨æ˜¯ä¸ç”˜å¿ƒ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dev.Gaoçš„å­¦ä¹ ç¬”è®°">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Swift5å­¦ä¹ ç¬”è®°ä¹‹å†…å­˜ç®¡ç†
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-10-22 11:04:06" itemprop="dateCreated datePublished" datetime="2019-10-22T11:04:06+08:00">2019-10-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index"><span itemprop="name">iOS</span></a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/Swift/" itemprop="url" rel="index"><span itemprop="name">Swift</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><ul>
<li>è·Ÿ<code>OC</code>ä¸€æ ·ï¼Œ<code>Swfit</code>ä¹Ÿæ˜¯é‡‡å–åŸºäºå¼•ç”¨è®¡æ•°çš„ARCå†…å­˜ç®¡ç†æ–¹æ¡ˆ(é’ˆå¯¹å †ç©ºé—´)</li>
<li><code>Swfit</code>çš„ARCä¸­æœ‰3ç§å¼•ç”¨<ul>
<li>å¼ºå¼•ç”¨(strong reference): é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼•ç”¨éƒ½æ˜¯å¼ºå¼•ç”¨</li>
<li>å¼±å¼•ç”¨(weak refierence): é€šè¿‡<code>weak</code>å®šä¹‰å¼±å¼•ç”¨<ul>
<li>å¼±å¼•ç”¨å¿…é¡»æ˜¯å¯é€‰ç±»å‹çš„<code>var</code>ï¼Œå› ä¸ºå®ä¾‹é”€æ¯åï¼ŒARCä¼šè‡ªåŠ¨å°†å¼±å¼•ç”¨è®¾ç½®ä¸º<code>nil</code></li>
<li>ARCè‡ªåŠ¨ç»™å¼±å¼•ç”¨è®¾ç½®<code>nil</code>æ—¶ï¼Œä¸ä¼šè§¦å‘å±æ€§è§‚å¯Ÿå™¨</li>
</ul>
</li>
<li>æ— ä¸»å¼•ç”¨(unowend reference)ï¼šé€šè¿‡<code>unowned</code>å®šä¹‰æ— ä¸»å¼•ç”¨<ul>
<li>ä¸ä¼šäº§ç”Ÿå¼ºå¼•ç”¨ï¼Œå®ä¾‹é”€æ¯åä»ç„¶å­˜å‚¨ç€å®ä¾‹çš„å†…å­˜åœ°å€(ç±»ä¼¼äºOCä¸­çš„<code>unsafe_unretained</code>)</li>
<li>è¯•å›¾åœ¨å®ä¾‹é”€æ¯åè®¿é—®æ— ä¸»å¼•ç”¨ï¼Œä¼šäº§ç”Ÿè¿è¡Œæ—¶é”™è¯¯(é‡æŒ‡é’ˆ)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="weakã€unownedçš„ä½¿ç”¨é™åˆ¶"><a href="#weakã€unownedçš„ä½¿ç”¨é™åˆ¶" class="headerlink" title="weakã€unownedçš„ä½¿ç”¨é™åˆ¶"></a>weakã€unownedçš„ä½¿ç”¨é™åˆ¶</h2><ul>
<li><p><code>weak</code>ï¼Œ<code>unowned</code>åªèƒ½ç”¨åœ¨ç±»å®ä¾‹ä¸Šé¢</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//AnyObjectä»£è¡¨åªèƒ½ç”¨ç±»å®ç°è¯¥å®ä¾‹</span></span><br><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Liveable</span>: <span class="title">AnyObject</span> </span>&#123; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">weak</span> <span class="keyword">var</span> p0: <span class="type">Person?</span></span><br><span class="line"><span class="keyword">weak</span> <span class="keyword">var</span> p1: <span class="type">AnyObject?</span></span><br><span class="line"><span class="keyword">weak</span> <span class="keyword">var</span> p2: <span class="type">Liveable?</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unowned</span> <span class="keyword">var</span> p10: <span class="type">Person?</span></span><br><span class="line"><span class="keyword">unowned</span> <span class="keyword">let</span> p11: <span class="type">Person</span></span><br><span class="line"><span class="keyword">unowned</span> <span class="keyword">var</span> p12: <span class="type">AnyObject</span></span><br><span class="line"><span class="keyword">unowned</span> <span class="keyword">var</span> p13: <span class="type">Liveable</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Autoreleasepool"><a href="#Autoreleasepool" class="headerlink" title="Autoreleasepool"></a>Autoreleasepool</h2><p><code>Swift</code>ä¸­ä¹Ÿä¿ç•™äº†<code>Autoreleasepool</code>ã€‚<code>Autoreleasepool</code>æ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œ</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// autoreleasepoolçš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">autoreleasepool</span>&lt;Result&gt;<span class="params">(invoking body: <span class="params">()</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Result</span>) <span class="keyword">rethrows</span> -&gt; <span class="type">Result</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ä½¿ç”¨ä¸Šï¼Œè°ƒç”¨<code>autoreleasepool</code>å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå°¾éšé—­åŒ…å³å¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">autoreleasepool &#123;</span><br><span class="line">    <span class="keyword">let</span> p = <span class="type">Person</span>()</span><br><span class="line">    p.run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¾ªç¯å¼•ç”¨-Reference-Cycle"><a href="#å¾ªç¯å¼•ç”¨-Reference-Cycle" class="headerlink" title="å¾ªç¯å¼•ç”¨(Reference Cycle)"></a>å¾ªç¯å¼•ç”¨(Reference Cycle)</h2><p><code>weak</code>ã€<code>unowned</code>éƒ½èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œ<code>unowned</code>è¦æ¯”<code>weak</code>å°‘ä¸€äº›æ€§èƒ½æ¶ˆè€—(å› ä¸º<code>unowned</code>ä¸éœ€è¦ç½®ä¸º<code>nil</code>)</p>
<ul>
<li>åœ¨ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½ä¼šå˜ä¸º<code>nil</code>çš„ä½¿ç”¨<code>weak</code></li>
<li>åˆå§‹åŒ–èµ‹å€¼åå†ä¹Ÿä¸ä¼šå˜ä¸º<code>nil</code>çš„ä½¿ç”¨<code>unowned</code></li>
</ul>
<h2 id="é—­åŒ…çš„å¾ªç¯å¼•ç”¨"><a href="#é—­åŒ…çš„å¾ªç¯å¼•ç”¨" class="headerlink" title="é—­åŒ…çš„å¾ªç¯å¼•ç”¨"></a>é—­åŒ…çš„å¾ªç¯å¼•ç”¨</h2><p>é—­åŒ…è¡¨è¾¾å¼é»˜è®¤ä¼šå¯¹ç”¨åˆ°çš„å¤–å±‚å¯¹è±¡äº§ç”Ÿé¢å¤–çš„å¼ºå¼•ç”¨(å¯¹å¤–å±‚å¯¹è±¡è¿›è¡Œ<code>retain</code>æ“ä½œ)</p>
<p><em>ä¸‹é¢ä»£ç ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œå¯¼è‡´<code>Person</code>å¯¹è±¡æ— æ³•é‡Šæ”¾</em></p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fn: (() -&gt; ())?</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123; <span class="built_in">print</span>(<span class="string">&quot;run&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">deinit</span> &#123; <span class="built_in">print</span>(<span class="string">&quot;deinit&quot;</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> p = <span class="type">Person</span>()</span><br><span class="line">    p.fn = &#123; p.run() &#125;</span><br><span class="line">    <span class="comment">//p.fn?()</span></span><br><span class="line">&#125;</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>

<p>åœ¨é—­åŒ…è¡¨è¾¾å¼çš„<strong>æ•è·åˆ—è¡¨</strong>å£°æ˜<code>weak</code>æˆ–<code>unowened</code>å¼•ç”¨ï¼Œè§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚ä½¿ç”¨<code>weak</code>è¦ä½¿ç”¨å¯é€‰é¡¹ï¼Œ<code>unowened</code>ä¸ç”¨</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fn: (() -&gt; ())?</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123; <span class="built_in">print</span>(<span class="string">&quot;run&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">deinit</span> &#123; <span class="built_in">print</span>(<span class="string">&quot;deinit&quot;</span>) &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> p = <span class="type">Person</span>()</span><br><span class="line">    p.fn = &#123;</span><br><span class="line">      [<span class="keyword">weak</span> p] <span class="keyword">in</span> </span><br><span class="line">      p?.run()</span><br><span class="line">    &#125;</span><br><span class="line">  p.fn = &#123;</span><br><span class="line">    [<span class="keyword">weak</span> weakP = p] <span class="keyword">in</span></span><br><span class="line">    weakP?.run()</span><br><span class="line">  &#125;</span><br><span class="line">  p.fn = &#123;</span><br><span class="line">    [<span class="keyword">unowned</span> p] <span class="keyword">in</span></span><br><span class="line">      p.run()</span><br><span class="line">  &#125;</span><br><span class="line">  p.fn = &#123;</span><br><span class="line">    [<span class="keyword">weak</span> wp = p, <span class="keyword">unowned</span> up = p, a = <span class="number">10</span> + <span class="number">20</span>] <span class="keyword">in</span></span><br><span class="line">    wp?.run()</span><br><span class="line">    up.run()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³åœ¨å®šä¹‰é—­åŒ…å±æ€§çš„åŒæ—¶å¼•ç”¨<code>self</code>ï¼Œè¿™ä¸ªé—­åŒ…å¿…é¡»æ˜¯<code>lazy</code>çš„(å› ä¸ºåœ¨å®ä¾‹åˆå§‹åŒ–å®Œæ¯•ä¹‹åæ‰èƒ½å¼•ç”¨<code>self</code>)ã€‚é—­åŒ…å‡½æ•°å†…å¦‚æœç”¨çš„å®ä¾‹æˆå‘˜(å±æ€§ã€æ–¹æ³•)ï¼Œç¼–è¯‘å™¨ä¼šå¼ºåˆ¶è¦æ±‚æ˜ç¡®å†™å‡º<code>self</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> fn: (() -&gt; ()) = &#123;</span><br><span class="line">        [<span class="keyword">weak</span> <span class="keyword">self</span>] <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">self</span>?.run()  <span class="comment">//ç¼–è¯‘å™¨è¦æ±‚å¼ºåˆ¶å†™æ˜self</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123; <span class="built_in">print</span>(<span class="string">&quot;run&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">deinit</span> &#123; <span class="built_in">print</span>(<span class="string">&quot;Student run&quot;</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ<code>lazy</code>å±æ€§æ˜¯é—­åŒ…è°ƒç”¨çš„ç»“æœï¼Œé‚£ä¹ˆä¸ç”¨è€ƒè™‘å¾ªç¯å¼•ç”¨çš„é—®é¢˜(å› ä¸ºé—­åŒ…è°ƒç”¨åï¼Œé—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸå°±ç»“æŸäº†)</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wirtor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">0</span></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> getAge: <span class="type">Int</span> = &#123;</span><br><span class="line">        <span class="keyword">self</span>.age </span><br><span class="line">    &#125;()  <span class="comment">//è¿™ä¸ªåŠ äº† (),ä»£è¡¨è¿™ä¸ªé—­åŒ…è¡¨è¾¾å¼è¿è¡Œè¿”å›ç»“æœã€‚</span></span><br><span class="line">    <span class="keyword">deinit</span> &#123; <span class="built_in">print</span>(<span class="string">&quot;wirtor deinit&quot;</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é€ƒé€¸é—­åŒ…ä¸éé€ƒé€¸é—­åŒ…"><a href="#é€ƒé€¸é—­åŒ…ä¸éé€ƒé€¸é—­åŒ…" class="headerlink" title="é€ƒé€¸é—­åŒ…ä¸éé€ƒé€¸é—­åŒ…"></a>é€ƒé€¸é—­åŒ…ä¸éé€ƒé€¸é—­åŒ…</h2><p>é€ƒé€¸é—­åŒ…ã€éé€ƒé€¸é—­åŒ…ï¼Œä¸€èˆ¬éƒ½æ˜¯å½“åšå‚æ•°ä¼ é€’ç»™å‡½æ•°</p>
<p><strong>éé€ƒé€¸é—­åŒ…</strong>ï¼šé—­åŒ…è°ƒç”¨å‘ç”Ÿåœ¨å‡½æ•°ç»“æŸå‰ï¼Œé—­åŒ…è°ƒç”¨åœ¨å‡½æ•°ä½œç”¨åŸŸå†…</p>
<p><strong>é€ƒé€¸é—­åŒ…</strong>ï¼šé—­åŒ…æœ‰å¯èƒ½åœ¨å‡½æ•°ç»“æŸåè°ƒç”¨ï¼Œé—­åŒ…è°ƒç”¨é€ƒç¦»äº†å‡½æ•°çš„ä½œç”¨åŸŸï¼Œéœ€è¦é€šè¿‡<code>@eacaping</code>å£°æ˜</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//fnæ˜¯éé€ƒé€¸é—­åŒ…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test1</span><span class="params">(<span class="number">_</span> fn: Fn)</span></span> &#123; fn() &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//fnæ˜¯é€ƒé€¸é—­åŒ…</span></span><br><span class="line"><span class="keyword">var</span> gFn: <span class="type">Fn?</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test2</span><span class="params">(<span class="number">_</span> fn: @escaping Fn)</span></span> &#123;</span><br><span class="line">    gFn = fn</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//fnæ˜¯é€ƒé€¸é—­åŒ…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test3</span><span class="params">(<span class="number">_</span> fn: @escaping Fn)</span></span> &#123;</span><br><span class="line">    <span class="type">DispatchQueue</span>.global().async &#123;</span><br><span class="line">        fn()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€ƒé€¸é—­åŒ…å†…å¦‚æœè®¿é—®å®ä¾‹çš„æˆå‘˜ï¼ˆå±æ€§ã€æ–¹æ³•ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šå¼ºåˆ¶è¦æ±‚å†™æ˜<code>self</code></p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> fn: <span class="type">Fn</span></span><br><span class="line">    <span class="comment">//fnæ˜¯ä¸€ä¸ªé€ƒé€¸é—­åŒ…</span></span><br><span class="line">    <span class="keyword">init</span>(fn: @escaping <span class="type">Fn</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.fn = fn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">run</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">//DispatchQueue.global().async ä¹Ÿæ˜¯ä¸€ä¸ªé€ƒé€¸é—­åŒ…</span></span><br><span class="line">        <span class="comment">//å®ƒç”¨åˆ°äº†å®ä¾‹æˆå‘˜(å±æ€§ï¼Œæ–¹æ³•)ï¼Œç¼–è¯‘å™¨ä¼šè¦å¼ºåˆ¶å†™æ˜self</span></span><br><span class="line">        <span class="comment">//å†™æ˜selfçš„ä½œç”¨</span></span><br><span class="line">        <span class="comment">//1ï¼šé€ƒé€¸é—­åŒ…ä¼šå¯¹å®ä¾‹äº§ç”Ÿå¼ºå¼•ç”¨ï¼Œä¸è‡³äºç­‰åˆ°é€ƒé€¸é—­åŒ…æ‰§è¡Œæ—¶ï¼Œå®ä¾‹è¢«é”€æ¯äº†</span></span><br><span class="line">        <span class="comment">//2ï¼šæé†’å¼€å‘è€…åœ¨é€ƒé€¸é—­åŒ…è®¿é—®å®ä¾‹æ—¶ï¼Œæ˜¯ä¸æ˜¯è¦ä½¿ç”¨weak</span></span><br><span class="line">        <span class="type">DispatchQueue</span>.global().async &#123;</span><br><span class="line">            <span class="keyword">self</span>.fn()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ï¼Œ<strong>é€ƒé€¸é—­åŒ…ä¸èƒ½æ•è·<code>inout</code>å‚æ•°</strong>ï¼Œå› ä¸ºé€ƒé€¸é—­åŒ…æ‰§è¡Œæ—¶æœºä¸ç¡®å®šï¼Œè€Œé€šè¿‡<code>inout</code>ä¼ å…¥çš„å†…å­˜åœ°å€å­˜åœ¨ï¼Œæ— æ³•ä¿è¯åœ¨é€ƒé€¸é—­åŒ…æ‰§è¡Œæ—¶è¿˜æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Fn</span> = () -&gt; ()</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">other1</span><span class="params">(<span class="number">_</span> fn: Fn)</span></span> &#123;</span><br><span class="line">    fn()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">other2</span><span class="params">(<span class="number">_</span> fn: @escaping Fn)</span></span> &#123;</span><br><span class="line">    fn()</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testInout</span><span class="params">(value: <span class="keyword">inout</span> Int)</span></span> -&gt; <span class="type">Fn</span> &#123;</span><br><span class="line">    other1 &#123;</span><br><span class="line">        value += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    other2 &#123; <span class="comment">//Error: Escaping closure captures &#x27;inout&#x27; parameter &#x27;value&#x27;</span></span><br><span class="line">        value += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">plus</span><span class="params">()</span></span> &#123;</span><br><span class="line">        value += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> plus <span class="comment">//Error: Escaping closure captures &#x27;inout&#x27; parameter &#x27;value&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å†…å­˜è®¿é—®å†²çª"><a href="#å†…å­˜è®¿é—®å†²çª" class="headerlink" title="å†…å­˜è®¿é—®å†²çª"></a>å†…å­˜è®¿é—®å†²çª</h2><p>è¿™é‡Œè¯´çš„å†…å­˜è®¿é—®å†²çªï¼Œå¹¶éæ˜¯åœ¨å¤šçº¿ç¨‹çš„çš„æƒ…å†µï¼Œå½“ä¸¤ä¸ªè®¿é—®æ»¡è¶³ä¸‹åˆ—æ¡ä»¶æ—¶å°±ä¼šå‘ç”Ÿï¼š</p>
<ol>
<li>è‡³å°‘æ˜¯ä¸€ä¸ªå†™å…¥æ“ä½œ</li>
<li>ä»–ä»¬è®¿é—®çš„æ˜¯åŒä¸€å—å†…å­˜</li>
<li>ä»–ä»¬çš„è®¿é—®æ—¶é—´é‡å (æ¯”å¦‚åœ¨åŒä¸€ä¸ªå‡½æ•°å†…)</li>
</ol>
<p>è¿™ç§æ“ä½œåœ¨å…¶ä»–è¯­è¨€ä¹Ÿè®¸æ˜¯å¯ä»¥çš„ï¼Œä½†<code>swift</code>ä¸­ï¼Œç¼–è¯‘å™¨æ£€æµ‹å‡ºè¿™ç§æ“ä½œå°±ä¼šæŠ¥é”™ï¼Œå³ä¾¿æ²¡æœ‰æ£€æµ‹å‡ºä¹Ÿä¼šåœ¨è¿è¡Œæ—¶æŠ¥é”™ã€‚ä¸¾å‡ ä¸ªğŸŒ°æ¥è¯´æ˜ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> step = <span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">increment</span><span class="params">(<span class="number">_</span> num: <span class="keyword">inout</span> Int)</span></span> &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœä¼ å…¥çš„å‚æ•°å°±æ˜¯step,</span></span><br><span class="line">    <span class="comment">//é‚£ä¹ˆè¿™é‡Œå¯¹stepå³è¿›è¡Œäº†è¯»å–ï¼Œä¹Ÿè¿›è¡Œäº†å†™å…¥çš„æ“ä½œ</span></span><br><span class="line">    num = num + step</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å­˜åœ¨è®¿é—®å†²çª</span></span><br><span class="line"><span class="comment">//Simultaneous accesses to 0x10000c8c8,but modification requires exclusive access</span></span><br><span class="line">increment(&amp;step)</span><br></pre></td></tr></table></figure>

<p>å†ä¾‹å¦‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">balance</span><span class="params">(<span class="number">_</span> x: <span class="keyword">inout</span> Int, <span class="number">_</span> y: <span class="keyword">inout</span> Int)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> sum = x + y</span><br><span class="line">    x =  sum / <span class="number">2</span></span><br><span class="line">    y = sum - x</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> num1 = <span class="number">42</span></span><br><span class="line"><span class="keyword">var</span> num2 = <span class="number">30</span></span><br><span class="line">balance(&amp;num1, &amp;num2) <span class="comment">//OK</span></span><br><span class="line"><span class="comment">//balance(&amp;num1, &amp;num1) //Error</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Player</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> health: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> energy: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">shareHealth</span><span class="params">(with teammate: <span class="keyword">inout</span> Player)</span></span> &#123;</span><br><span class="line">        balance(&amp;teammate.health, &amp;health)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> oscar = <span class="type">Player</span>(name: <span class="string">&quot;Oscar&quot;</span>, health: <span class="number">10</span>, energy: <span class="number">10</span>)</span><br><span class="line"><span class="keyword">var</span> maris = <span class="type">Player</span>(name: <span class="string">&quot;Maria&quot;</span>, health: <span class="number">5</span>, energy: <span class="number">10</span>)</span><br><span class="line">oscar.shareHealth(with: &amp;maris) <span class="comment">//ok</span></span><br><span class="line"><span class="comment">//oscar.shareHealth(with: &amp;oscar) //Error</span></span><br><span class="line"><span class="keyword">var</span> tulpe = (health: <span class="number">10</span>,energy: <span class="number">20</span>)</span><br><span class="line"><span class="comment">//Error:Thread 1: Simultaneous accesses to 0x10000c928, but modification requires exclusive access</span></span><br><span class="line">balance(&amp;tulpe.health, &amp;tulpe.energy) </span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸‹é¢çš„æ¡ä»¶å¯ä»¥æ»¡è¶³ï¼Œå°±è¯´æ˜é‡å è®¿é—®ç»“æ„ä½“çš„å±æ€§æ˜¯å®‰å…¨çš„</p>
<ul>
<li>åªè®¿é—®å®ä¾‹å­˜å‚¨å±æ€§ï¼Œä¸æ˜¯è®¡ç®—å±æ€§æˆ–è€…ç±»å±æ€§</li>
<li>ç»“æ„ä½“æ˜¯å±€éƒ¨å˜é‡è€Œéå…¨å±€å˜é‡</li>
<li>ç»“æ„ä½“è¦ä¹ˆæ²¡æœ‰è¢«é—­åŒ…æ•è·è¦ä¹ˆåªè¢«éé€ƒé€¸é—­åŒ…æ•è·</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">balance</span><span class="params">(<span class="number">_</span> x: <span class="keyword">inout</span> Int, <span class="number">_</span> y: <span class="keyword">inout</span> Int)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> sum = x + y</span><br><span class="line">    x =  sum / <span class="number">2</span></span><br><span class="line">    y = sum - x</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ok</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">accessCoTest</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> tulpe = (health: <span class="number">10</span>,energy: <span class="number">20</span>)</span><br><span class="line">    balance(&amp;tulpe.health, &amp;tulpe.energy)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> holly = (name: <span class="string">&quot;Hello&quot;</span>,health: <span class="number">10</span>, energy: <span class="number">20</span>)</span><br><span class="line">    balance(&amp;holly.health, &amp;holly.energy)</span><br><span class="line">&#125;</span><br><span class="line">accessCoTest()</span><br></pre></td></tr></table></figure>

<h2 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h2><h3 id="å¸¸è§çš„å››ç§æŒ‡é’ˆç±»å‹"><a href="#å¸¸è§çš„å››ç§æŒ‡é’ˆç±»å‹" class="headerlink" title="å¸¸è§çš„å››ç§æŒ‡é’ˆç±»å‹"></a>å¸¸è§çš„å››ç§æŒ‡é’ˆç±»å‹</h3><p><code>Swfit</code>ä¸­ä¹Ÿæœ‰ä¸“é—¨çš„æŒ‡é’ˆç±»å‹ï¼Œè¿™äº›éƒ½è¢«å®šä¹‰ä¸ºâ€Unsafeâ€(ä¸å®‰å…¨çš„),å¸¸è§çš„æœ‰ä»¥ä¸‹å››ç§ç±»å‹</p>
<ul>
<li><code>UnsafePointer&lt;Pointee&gt;</code> ç±»ä¼¼äº <code>const Pointee *</code>ã€‚åªè¯»ï¼Œç±»å‹ç¡®å®šï¼Œä¸èƒ½æ›´æ”¹å†…å­˜æ•°æ®</li>
<li><code>UnsafeMutablePointer&lt;Pointee&gt;</code>ç±»ä¼¼äº<code>Pointee *</code>ã€‚ç±»å‹ç¡®å®šï¼Œå†…å­˜æ•°æ®å¯è¯»å¯å†™ã€‚</li>
<li><code>UnsafeRowPointer</code> ç±»ä¼¼äº <code>const void *</code>ã€‚åªè¯»ï¼Œç±»å‹ä¸ç¡®å®šï¼Œä¸èƒ½æ›´æ”¹å†…å­˜æ•°æ®ã€‚</li>
<li><code>UnsafeMutableRowPointer</code> ç±»ä¼¼äº <code>void *</code>ã€‚ç±»å‹ä¸ç¡®å®šï¼Œå†…å­˜æ•°æ®å¯è¯»å¯å†™ã€‚</li>
</ul>
<p><strong>å¯¹äº<code>UnsafePointer</code></strong></p>
<p><code>UnsafePointer</code>åœ¨ä½¿ç”¨æ—¶ï¼Œå¿…é¡»æŒ‡å®šæ³›å‹ç±»å‹ï¼Œå¦åˆ™ä¼šç¼–è¯‘æŠ¥é”™ã€‚é€šè¿‡<code>UnsafePointer.pointee</code>ä¹Ÿå¯ä»¥è¯»å–åˆ°å†…å­˜ä¸­å­˜å‚¨çš„æ•°æ®ã€‚å½“å‡½æ•°ä¸­å‚æ•°æ˜¯<code>UnsafePointer</code>æ—¶ï¼Œä¼ å‚æ—¶éœ€è¦ä½¿ç”¨<code>&amp;</code>,ä¾‹å¦‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">merroyTest1</span><span class="params">(<span class="number">_</span> ptr: UnsafePointer&lt;Int&gt;)</span></span> &#123;</span><br><span class="line">    <span class="comment">//é€šè¿‡pointeeå±æ€§è·å–è¯¥å†…å­˜çš„å€¼</span></span><br><span class="line">    <span class="built_in">print</span>(ptr.pointee) <span class="comment">//10</span></span><br><span class="line">&#125;</span><br><span class="line">merroyTest1(&amp;age) </span><br></pre></td></tr></table></figure>

<p><strong>å¯¹äº<code>UnsafeMutablePointer</code></strong></p>
<p><code>UnsafeMutablePointer</code>ä¸<code>UnsafePointer</code>åœ¨ä½¿ç”¨æ—¶å¤§ä½“ç›¸åŒï¼Œä¸è¿‡<code>UnsafeMutablePointer</code>æ˜¯å¯è¯»å†™çš„ï¼Œå…è®¸å¯¹å†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œè¯»å†™,ä¾‹å¦‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">merroyTest2</span><span class="params">(<span class="number">_</span> ptr: UnsafeMutablePointer&lt;Int&gt;)</span></span> &#123;</span><br><span class="line">    ptr.pointee += <span class="number">10</span> <span class="comment">//UnsafeMutablePointer.pointee,å¯è¯»å†™</span></span><br><span class="line">    <span class="built_in">print</span>(ptr.pointee) <span class="comment">//20</span></span><br><span class="line">&#125;</span><br><span class="line">merroyTest2(&amp;age)</span><br><span class="line"><span class="built_in">print</span>(age) <span class="comment">//20</span></span><br></pre></td></tr></table></figure>

<p><strong>å¯¹äº<code>UnsafeRawPointer</code></strong></p>
<p><code>UnsafeRawPointer</code>ç±»å‹æ˜¯ä¸ç¡®å®šå†…å­˜ä¸­æ•°æ®ç±»å‹çš„ï¼Œä½†å¯ä»¥ä½¿ç”¨<code>load</code>æ–¹æ³•è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">merroyTest3</span><span class="params">(<span class="number">_</span> ptr: UnsafeRawPointer)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(ptr.load(<span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>))</span><br><span class="line">&#125;</span><br><span class="line">merroyTest3(&amp;age)<span class="comment">//10</span></span><br></pre></td></tr></table></figure>

<p><strong>å¯¹äº<code>UnsafeMutableRawPointer</code></strong></p>
<p>ç›¸æ¯”äº<code>UnsafeRawPointer</code>ï¼Œ<code>UnsafeMutableRawPointer</code>å¯ä»¥ä½¿ç”¨<code>storeBytes</code>æ–¹æ³•ä»¥æŒ‡å®šçš„ç±»å‹å‘å†…å­˜ä¸­å†™å…¥æ•°æ®ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">merroyTest4</span><span class="params">(<span class="number">_</span> ptr: UnsafeMutableRawPointer)</span></span> &#123;</span><br><span class="line">    ptr.storeBytes(of: <span class="number">20</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line">&#125;</span><br><span class="line">merroyTest4(&amp;age)</span><br><span class="line"><span class="built_in">print</span>(age) <span class="comment">//20</span></span><br></pre></td></tr></table></figure>

<h3 id="è·å¾—æŒ‡å‘æŸä¸ªå˜é‡çš„æŒ‡é’ˆ"><a href="#è·å¾—æŒ‡å‘æŸä¸ªå˜é‡çš„æŒ‡é’ˆ" class="headerlink" title="è·å¾—æŒ‡å‘æŸä¸ªå˜é‡çš„æŒ‡é’ˆ"></a>è·å¾—æŒ‡å‘æŸä¸ªå˜é‡çš„æŒ‡é’ˆ</h3><p><code>Swift</code>ä¸­æä¾›äº†ä¸¤ä¸ªå‡½æ•°æ¥è·å–å˜é‡çš„æŒ‡é’ˆ,ä¸‹é¢æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°çš„åŸå‹ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">@inlinable <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">withUnsafeMutablePointer</span>&lt;T, Result&gt;<span class="params">(to value: <span class="keyword">inout</span> T, <span class="number">_</span> body: <span class="params">(UnsafeMutablePointer&lt;T&gt;)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Result</span>) <span class="keyword">rethrows</span> -&gt; <span class="type">Result</span></span><br><span class="line"></span><br><span class="line">@inlinable <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">withUnsafePointer</span>&lt;T, Result&gt;<span class="params">(to value: <span class="keyword">inout</span> T, <span class="number">_</span> body: <span class="params">(UnsafePointer&lt;T&gt;)</span></span></span> <span class="keyword">throws</span> -&gt; <span class="type">Result</span>) <span class="keyword">rethrows</span> -&gt; <span class="type">Result</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªä¸¤ä¸ªå‡½æ•°ä»åå­—å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªæ˜¯è¿”å›ä¸å¯å˜æŒ‡é’ˆçš„ï¼Œä¸€ä¸ªæ˜¯è¿”å›å¯å˜æŒ‡é’ˆçš„ã€‚è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥è¦è·å–æŒ‡é’ˆçš„å˜é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ä¸€ä¸ªé—­åŒ…è¡¨è¾¾å¼ï¼Œè¿™ä¸ªé—­åŒ…è¡¨è¾¾å¼ï¼Œæ¥å—çš„å‚æ•°å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°çš„åœ°å€å€¼ï¼Œå¹¶ä¸”è¿™ä¸ªé—­åŒ…çš„è¿”å›å€¼ç±»å‹å°±æ˜¯å‡½æ•°çš„è¿”å›å€¼ç±»å‹ã€‚å‡½æ•°çš„ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> ptr = <span class="built_in">withUnsafePointer</span>(to: &amp;age) &#123; (agePtr) -&gt; <span class="type">UnsafePointer</span>&lt;<span class="type">Int</span>&gt; <span class="keyword">in</span></span><br><span class="line">    <span class="comment">//ä½¿ç”¨å½¢å‚agePtræ¥æ¥æ”¶ageçš„æŒ‡é’ˆï¼Œå¹¶è¿”å›ã€‚</span></span><br><span class="line">       <span class="keyword">return</span> agePtr</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ptrçš„ç±»å‹å°±æ˜¯UnsafePointer&lt;Int&gt;</span></span><br><span class="line"><span class="built_in">print</span>(ptr) <span class="comment">//0x000000010000c9b0</span></span><br><span class="line"><span class="built_in">print</span>(ptr.pointee) <span class="comment">//10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¹Ÿå¯ä»¥ç›´æ¥ç®€å†™ä¸ºä¸€ä¸ªå°¾éšé—­åŒ…</span></span><br><span class="line"><span class="keyword">var</span> agePtr = <span class="built_in">withUnsafePointer</span>(to: &amp;age) &#123; $<span class="number">0</span> &#125; <span class="comment">//$0ä»£è¡¨ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line"><span class="built_in">print</span>(agePtr) <span class="comment">//0x000000010000c9b0</span></span><br><span class="line"><span class="built_in">print</span>(agePtr.pointee) <span class="comment">//10</span></span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥å°†å˜é‡çš„æŒ‡é’ˆåŒ…è£…æˆ<code>UnsafeMuatableRawPointer</code>å’Œ<code>UnsafeRawPointer</code>ç±»å‹ï¼Œæ¥éšè—ç±»å‹</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> aNumber = <span class="number">20</span></span><br><span class="line"><span class="keyword">var</span> ptr4 = <span class="built_in">withUnsafeMutablePointer</span>(to: &amp;aNumber) &#123;</span><br><span class="line">    <span class="comment">//UnsafeMutableRawPointerçš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="type">UnsafeMutableRawPointer</span>($<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ptr4:&quot;</span>,ptr4.load(<span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)) <span class="comment">//ptr4: 20</span></span><br><span class="line">ptr4.storeBytes(of: <span class="number">2</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ptr3 = <span class="built_in">withUnsafePointer</span>(to: &amp;aNumber) &#123;</span><br><span class="line">    <span class="comment">//UnsafeRawPointerçš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="type">UnsafeRawPointer</span>($<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ptr3:&quot;</span>,ptr3.load(<span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>))<span class="comment">//ptr3: 2</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<strong>è¿™ä¸ªå‡½æ•°è·å–å¼•ç”¨ç±»å‹çš„åœ°å€å€¼ï¼Œä½†è·å–çš„å¹¶ä¸æ˜¯è¯¥å¼•ç”¨ç±»å‹åœ¨å †ç©ºé—´çš„åœ°å€å€¼ï¼Œè€Œæ˜¯è·å–å¼•ç”¨ç±»å‹å˜é‡çš„åœ°å€å€¼</strong></p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person4</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="type">Person4</span>()</span><br><span class="line"><span class="keyword">var</span> pptr = <span class="built_in">withUnsafePointer</span>(to: &amp;p) &#123; $<span class="number">0</span> &#125;</span><br><span class="line"><span class="comment">//pptr æ˜¯ å˜é‡pçš„åœ°å€å€¼</span></span><br><span class="line"><span class="built_in">print</span>(pptr) <span class="comment">//0x000000010000cb40</span></span><br><span class="line"><span class="built_in">print</span>(pptr.pointee.age) <span class="comment">//10</span></span><br></pre></td></tr></table></figure>

<h3 id="è·å–æŒ‡å‘å †ç©ºé—´å®ä¾‹çš„æŒ‡é’ˆ"><a href="#è·å–æŒ‡å‘å †ç©ºé—´å®ä¾‹çš„æŒ‡é’ˆ" class="headerlink" title="è·å–æŒ‡å‘å †ç©ºé—´å®ä¾‹çš„æŒ‡é’ˆ"></a>è·å–æŒ‡å‘å †ç©ºé—´å®ä¾‹çš„æŒ‡é’ˆ</h3><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œä½¿ç”¨<code>withUnsafePointer</code>å‡½æ•°**è·å–äº†å¼•ç”¨ç±»å‹å˜é‡æœ¬èº«çš„æŒ‡é’ˆï¼Œå¹¶ä¸æ˜¯å¼•ç”¨ç±»å‹åœ¨å †ç©ºé—´çš„åœ°å€å€¼ã€‚è‹¥è¦è·å–å¼•ç”¨ç±»å‹å˜å‹ä¸­ä¿å­˜çš„æŒ‡å‘å †ç©ºé—´çš„åœ°å€å€¼åˆ™éœ€è¦é€šè¿‡<code>UnsafeRawPointer(bitPattern: )</code>**ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person4</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="type">Person4</span>()</span><br><span class="line"><span class="keyword">var</span> pptr = <span class="built_in">withUnsafePointer</span>(to: &amp;p) &#123; <span class="type">UnsafeRawPointer</span>($<span class="number">0</span>) &#125;</span><br><span class="line"><span class="comment">//pptr æ˜¯ å˜é‡pçš„åœ°å€å€¼</span></span><br><span class="line"><span class="built_in">print</span>(pptr) <span class="comment">//0x0000000100010b60</span></span><br><span class="line"><span class="built_in">print</span>(pptr.load(<span class="keyword">as</span>: <span class="type">Person4</span>.<span class="keyword">self</span>)) <span class="comment">//Person4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> heapPtr = <span class="type">UnsafeRawPointer</span>(bitPattern: pptr.load(<span class="keyword">as</span>: <span class="type">UInt</span>.<span class="keyword">self</span>))</span><br><span class="line"><span class="built_in">print</span>(heapPtr!) <span class="comment">//0x0000000102155a80 å †ç©ºé—´åœ°å€å€¼</span></span><br><span class="line"><span class="built_in">print</span>(heapPtr?.load(<span class="keyword">as</span>: <span class="type">Person4</span>.<span class="keyword">self</span>) <span class="keyword">as</span> <span class="type">Any</span>) <span class="comment">//Optional(Person4)</span></span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>unsafeBitCast</code>å‡½æ•°</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p4ptr = <span class="built_in">unsafeBitCast</span>(p, to: <span class="type">UnsafeRawPointer</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="built_in">print</span>(p4ptr) <span class="comment">//0x0000000102155a80</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºæŒ‡é’ˆ"><a href="#åˆ›å»ºæŒ‡é’ˆ" class="headerlink" title="åˆ›å»ºæŒ‡é’ˆ"></a>åˆ›å»ºæŒ‡é’ˆ</h3><p>ä¸Šé¢è®²çš„æ˜¯å·²æœ‰ä¸€ä¸ªåœ¨å †ç©ºé—´çš„å˜é‡ï¼Œè·å–æŒ‡å‘è¿™ä¸ªå˜é‡çš„æŒ‡é’ˆã€‚é‚£ä¹ˆæ˜¯å¦èƒ½ç›´æ¥å‘å †ç©ºé—´ç”³è¯·ä¸€æ®µå†…å­˜å‘¢ã€‚ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œ<code>Swfit</code>åŒæ ·ä¹Ÿæ”¯æŒè¿™æ ·çš„æ“ä½œï¼Œå¹¶ä¸”åœ¨<code>HandyJson</code>è¿™ä¸ªåº“ä¸­å¤§é‡çš„ä½¿ç”¨äº†æŒ‡é’ˆçš„ä»£ç ã€‚</p>
<h4 id="ç¬¬ä¸€ç§æ–¹å¼"><a href="#ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼"></a>ç¬¬ä¸€ç§æ–¹å¼</h4><p>å¼•å…¥<code>Foundtion</code>æ¡†æ¶ï¼Œä½¿ç”¨<code>malloc</code>å‡½æ•°ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºï¼Œ</span></span><br><span class="line"><span class="comment">//å‘å †ç©ºé—´ç”³è¯·16ä¸ªå­—èŠ‚çš„å†…å­˜ï¼Œ</span></span><br><span class="line"><span class="comment">//è¿”å› UnsafeMutableRawPointer? ç±»å‹çš„å˜é‡ï¼ˆå¯è¯»å†™ï¼‰</span></span><br><span class="line"><span class="keyword">var</span> myPtr = malloc(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­˜</span></span><br><span class="line"><span class="comment">//é»˜è®¤ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹å­˜å‚¨ï¼Œä»¥Intå‹ï¼ˆ8ä¸ªå­—èŠ‚ï¼‰ï¼Œå­˜å…¥æ•°æ® 11</span></span><br><span class="line">myPtr?.storeBytes(of: <span class="number">11</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="comment">//ä½†æ˜¯ myPtr æœ‰16ä¸ªè‡ªå·±ï¼Œå‰é¢å ç”¨äº†8ä¸ªï¼Œ</span></span><br><span class="line"><span class="comment">//å¦‚æœæƒ³æ“ä½œåé¢çš„å†…å­˜å¯ä»¥ä½¿ç”¨åç§»é‡</span></span><br><span class="line"><span class="comment">//åç§»8ä¸ªå­—èŠ‚ï¼Œå†ä»¥Intå‹ï¼ˆ8ä¸ªå­—èŠ‚ï¼‰å­˜å…¥æ•°æ®22</span></span><br><span class="line">myPtr?.storeBytes(of: <span class="number">22</span>, toByteOffset: <span class="number">8</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å–</span></span><br><span class="line"><span class="comment">//ä»¥Intå‹ï¼ˆè¯»å–å‰8ä¸ªå­—èŠ‚ï¼‰,è·å–æŒ‡é’ˆä¸­çš„æ•°æ®,é»˜è®¤ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹è¯»å–</span></span><br><span class="line"><span class="built_in">print</span>((myPtr?.load(<span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>))!) <span class="comment">//11</span></span><br><span class="line"><span class="comment">//å¦‚æœæƒ³ä»å…·ä½“çš„æŸä¸ªå­—èŠ‚æ•°å¼€å§‹è¯»ï¼Œå¼€å§‹é€šè¿‡è®¾ç½®åç§»é‡æ¥å®Œæˆ</span></span><br><span class="line"><span class="comment">//åç§»8ä¸ªå­—èŠ‚,å†ä»¥Int(è¯»å–8ä¸ªå­—èŠ‚)å‹è¯»å–æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>((myPtr?.load(fromByteOffset: <span class="number">8</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>))!) <span class="comment">//22</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ€åä¸è¦å¿˜è®°é”€æ¯æŒ‡é’ˆ</span></span><br><span class="line">free(myPtr)</span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬äºŒç§æ–¹å¼"><a href="#ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼"></a>ç¬¬äºŒç§æ–¹å¼</h4><p>ä½¿ç”¨<code>UnsafeMutalbeRawPointer.allocate</code>å‡½æ•°</p>
<blockquote>
<p>å‡½æ•°åŸå‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">/// - Parameters:</span></span><br><span class="line"><span class="comment">///   - byteCount: è¦åˆ†é…çš„å­—èŠ‚æ•°ï¼Œä¸èƒ½ä¸ºè´Ÿæ•°</span></span><br><span class="line"><span class="comment">///   - alignment: å·²åˆ†é…å†…å­˜çš„æ–°åŒºåŸŸçš„å¯¹é½æ–¹å¼ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œä¸€èˆ¬å¡«1å°±å¯ä»¥</span></span><br><span class="line"><span class="comment">/// - Returns: æŒ‡å‘æ–°åˆ†é…çš„å†…å­˜åŒºåŸŸçš„æŒ‡é’ˆã€‚å†…å­˜å·²åˆ†é…ï¼Œä½†æœªåˆå§‹åŒ–ã€‚</span></span><br><span class="line"><span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">allocate</span><span class="params">(byteCount: Int, alignment: Int)</span></span> -&gt; <span class="type">UnsafeMutableRawPointer</span></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç”³è¯·ä¸€ä¸ª16å­—èŠ‚å†…å­˜ç©ºé—´,å¯¹é½æ–¹å¼ä¸€èˆ¬å¡«1</span></span><br><span class="line"><span class="keyword">var</span> myPtr2 = <span class="type">UnsafeMutableRawPointer</span>.allocate(byteCount: <span class="number">8</span>, alignment: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‘å‰å…«ä¸ªå­—èŠ‚å­˜å…¥Intå‹æ•´æ•°:8</span></span><br><span class="line">myPtr2.storeBytes(of: <span class="number">8</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//åç§»å­—èŠ‚é™¤äº†å¯ä»¥ç”¨  UnsafeMutableRawPointer.storeBytes(of: T, toByteOffset: Int, as: T.Type)ï¼Œä¹Ÿå¯ä»¥ç”¨advancedæ–¹æ³•</span></span><br><span class="line"><span class="comment">//è·å– myPtr2åç§»8ä¸ªå­—èŠ‚åçš„å†…å­˜æŒ‡é’ˆ,å­˜å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">var</span> offset8Mem = myPtr2.advanced(by: <span class="number">8</span>)</span><br><span class="line">offset8Mem.storeBytes(of: <span class="number">30</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myPtr2.load(<span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)) <span class="comment">// 8</span></span><br><span class="line"><span class="built_in">print</span>(myPtr2.advanced(by: <span class="number">8</span>).load(<span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)) <span class="comment">//30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//é”€æ¯,é™¤äº†å¯ä»¥ä½¿ç”¨freeå‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ UnsafeMutableRawPointer.deallocat()</span></span><br><span class="line">myPtr2.deallocate()</span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬ä¸‰ç§æ–¹å¼"><a href="#ç¬¬ä¸‰ç§æ–¹å¼" class="headerlink" title="ç¬¬ä¸‰ç§æ–¹å¼"></a>ç¬¬ä¸‰ç§æ–¹å¼</h4><p>ä½¿ç”¨<code>UnsafeMutablePointer&lt;T&gt;.allocte(capacity: Int)</code>æ¥ç”³è¯·å†…å­˜</p>
<p>è¿™ç§æ–¹å¼å¯ä»¥æŒ‡å®šç”³è¯·å†…å­˜çš„ç±»å‹ï¼Œä¼ å…¥çš„å®¹é‡å³ä¸ºå¤šå°‘ä¸ªè¯¥ç±»å‹çš„å†…å­˜ç©ºé—´</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç”³è¯·3ä¸ªIntå‹å†…å­˜ç©ºé—´,ä¸€ä¸ªIntå‹å 8ä¸ªå­—èŠ‚,è¯´ç™½äº†å°±æ˜¯24ä¸ªå­—èŠ‚</span></span><br><span class="line"><span class="keyword">var</span> myPtr3 = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int</span>&gt;.allocate(capacity: <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>initalize(to: T)</code>æ¥åˆå§‹åŒ–ï¼Œå¦‚æœæ²¡æœ‰åˆå§‹åŒ–ï¼Œè¯»åˆ°çš„æ•°æ®å°±æ˜¯å†…å­˜ä¸­åŸå§‹çš„æ•°æ®äº†ã€‚å¦å¤–ï¼Œå› ä¸ºåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œç”³è¯·çš„å†…å­˜å®¹é‡ä¸ä¸€å®šæ˜¯1ï¼Œå¯èƒ½æœ‰å¤šä¸ªæŒ‡å®šç±»å‹çš„å†…å­˜å®¹é‡å•ä½ï¼Œå¯ä»¥é€šè¿‡<code>successor()</code>å‡½æ•°æ¥è®¿é—®ä¸‹ä¸€ä¸ªç±»å‹èµ·å§‹ä½ç½®ã€‚</p>
<p><strong>è¯´ç™½äº†å°±æ˜¯ï¼Œåœ¨å®šä¹‰æŒ‡é’ˆæ—¶æŒ‡å®šçš„æ³›å‹Tï¼Œè°ƒç”¨æ¯è°ƒç”¨ä¸€æ¬¡<code>successor()</code>ï¼Œå°±è¿”å›å½“å‰æŒ‡é’ˆå‘ååç§»ä¸€ä¸ªTç±»å‹å˜é‡æ‰€å å†…å­˜å¤§å°çš„åç§»é‡ã€‚</strong></p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line">myPtr3.initialize(to: <span class="number">1</span>) <span class="comment">//ç¬¬ä¸€ä¸ªIntå†…å­˜ï¼ˆå‰å…«ä¸ªå­—èŠ‚ï¼‰åˆå§‹åŒ–ä¸º1</span></span><br><span class="line">myPtr3.successor().initialize(to: <span class="number">20</span>) <span class="comment">// ç¬¬äºŒä¸ªInt(ä¸­é—´å…«ä¸ªå­—èŠ‚)å†…å­˜åœ°å€åˆå§‹åŒ–ä¸º20</span></span><br><span class="line">myPtr3.successor().successor().initialize(to: <span class="number">33</span>) <span class="comment">//ç¬¬ä¸‰ä¸ªIntå†…å­˜ï¼ˆæœ€åå…«ä¸ªå­—èŠ‚ï¼‰åˆå§‹åŒ–ä¸º33</span></span><br></pre></td></tr></table></figure>

<p>é™¤äº†ä½¿ç”¨<code>successor()</code>è·å–åç§»åçš„æŒ‡é’ˆï¼Œå¯ä»¥ä½¿ç”¨ä¸‹æ ‡å’ŒåŠ æ³•ã€‚</p>
<blockquote>
<p>æ³›å‹æŒ‡é’ˆä¸­ï¼ˆUnsafePointerå’ŒUnsafeMutablePointerï¼‰ï¼ŒæŒ‡é’ˆå˜é‡  â€œ +nâ€,åç§»nä¸ªæ³›å‹ç±»å‹çš„å˜é‡çš„å†…å­˜å­—èŠ‚æ•°</p>
<p>åŸç”ŸæŒ‡é’ˆä¸­(UnsafeRawPointerå’ŒUnsaeMutableRawPointer) ï¼ŒæŒ‡é’ˆå˜é‡  â€œ + nâ€,åç§»nä¸ªå†…å­˜å­—èŠ‚æ•°</p>
<p>var ptrT = UnsafeMutablePointer<Int>.allocate(capacity: 3);   ptrT + 1 //åç§»ä¸€ä¸ªIntå‹å˜é‡çš„å†…å­˜å­—èŠ‚(8ä¸ªå­—èŠ‚)</p>
<p>var  rowPtr = UnsafeMutableRawPointer(byteCount: 3 alignment: 1); rowPtr + 1 // åç§»1ä¸ªå­—èŠ‚</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨ä¸‹æ ‡æ¥åç§»æŒ‡é’ˆ</span></span><br><span class="line">myPtr3[<span class="number">0</span>] = <span class="number">5</span> <span class="comment">//ç¬¬ä¸€ä¸ªIntå†…å­˜ï¼ˆå‰å…«ä¸ªå­—èŠ‚ï¼‰åˆå§‹åŒ–ä¸º5</span></span><br><span class="line">myPtr3[<span class="number">1</span>] = <span class="number">21</span> <span class="comment">//ç¬¬äºŒä¸ªInt(ä¸­é—´å…«ä¸ªå­—èŠ‚)å†…å­˜åœ°å€åˆå§‹åŒ–ä¸º21</span></span><br><span class="line">myPtr3[<span class="number">2</span>] = <span class="number">25</span> <span class="comment">//ç¬¬ä¸‰ä¸ªIntå†…å­˜ï¼ˆæœ€åå…«ä¸ªå­—èŠ‚ï¼‰åˆå§‹åŒ–ä¸º25</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myPtr3[<span class="number">0</span>]) <span class="comment">//5</span></span><br><span class="line"><span class="built_in">print</span>(myPtr3[<span class="number">1</span>]) <span class="comment">//21</span></span><br><span class="line"><span class="built_in">print</span>(myPtr3[<span class="number">2</span>]) <span class="comment">//25</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨ â€+â€œ æ¥åç§»æŒ‡é’ˆ</span></span><br><span class="line">myPtr3.pointee = <span class="number">5</span> <span class="comment">//ç¬¬ä¸€ä¸ªIntå†…å­˜ï¼ˆå‰å…«ä¸ªå­—èŠ‚ï¼‰åˆå§‹åŒ–ä¸º5</span></span><br><span class="line">(myPtr3 + <span class="number">1</span>).pointee = <span class="number">21</span> <span class="comment">//ç¬¬äºŒä¸ªInt(ä¸­é—´å…«ä¸ªå­—èŠ‚)å†…å­˜åœ°å€åˆå§‹åŒ–ä¸º21</span></span><br><span class="line">(myPtr3 + <span class="number">2</span>).pointee = <span class="number">25</span> <span class="comment">//ç¬¬ä¸‰ä¸ªIntå†…å­˜ï¼ˆæœ€åå…«ä¸ªå­—èŠ‚ï¼‰åˆå§‹åŒ–ä¸º25</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myPtr3.pointee) <span class="comment">//5</span></span><br><span class="line"><span class="built_in">print</span>((myPtr3 + <span class="number">1</span>).pointee) <span class="comment">//21</span></span><br><span class="line"><span class="built_in">print</span>((myPtr3 + <span class="number">2</span>).pointee) <span class="comment">//25</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨å®Œåï¼Œè¦å¯¹æŒ‡é’ˆè¿›è¡Œååˆå§‹åŒ–æˆ–é”€æ¯</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ååˆå§‹åŒ–ï¼Œå¦‚æœä¸è¿›è¡Œè¿™ä¸€æ­¥ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚</span></span><br><span class="line"><span class="comment">//å¦‚æœå­˜å‚¨çš„æ˜¯å¯¹è±¡,å³ä½¿è°ƒç”¨äº†æŒ‡é’ˆçš„deallcate()ï¼Œå¯¹è±¡ä¾ç„¶ä¸ä¼šé”€æ¯</span></span><br><span class="line">myPtr3.deinitialize(<span class="built_in">count</span>: <span class="number">3</span>)</span><br><span class="line"><span class="comment">//é”€æ¯</span></span><br><span class="line">myPtr3.deallocate()</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‡é’ˆä¹‹é—´çš„è½¬æ¢"><a href="#æŒ‡é’ˆä¹‹é—´çš„è½¬æ¢" class="headerlink" title="æŒ‡é’ˆä¹‹é—´çš„è½¬æ¢"></a>æŒ‡é’ˆä¹‹é—´çš„è½¬æ¢</h3><ul>
<li><p><code>UnsafeMutableRawPointer</code> to <code>UnsafeMutablePointer&lt;T&gt;</code></p>
<ul>
<li><p>assumingMemoryBound</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> rawPtr = <span class="type">UnsafeMutableRawPointer</span>.allocate(byteCount: <span class="number">16</span>, alignment: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// assumingMemoryBound: å‡è®¾å†…å­˜ç»‘å®š</span></span><br><span class="line"><span class="comment">// rawPtræŒ‡é’ˆå‡è®¾ä¸º Intå‹æ¥è¯»å– (è·å–å‰å…«ä¸ªå­—èŠ‚),è¿”å›ä¸€ä¸ª Intæ³›å‹çš„UnsafeMutablePointer</span></span><br><span class="line"><span class="comment">//top8Ptrçš„ç±»å‹æ˜¯ UnsafeMutablePointer&lt;Int&gt;</span></span><br><span class="line"><span class="keyword">var</span> top8Ptr = rawPtr.assumingMemoryBound(to: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line">top8Ptr.pointee = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å°†rawPtråç§»8ä¸ªå­—èŠ‚åï¼Œè·å–åˆ°å8ä¸ªå­—èŠ‚</span></span><br><span class="line"><span class="comment">//å°†å8ä¸ªå­—èŠ‚å†…å­˜å‡è®¾ä¸ºDoubleè¡Œ,å†™å…¥ 2.0</span></span><br><span class="line">(rawPtr + <span class="number">8</span>).assumingMemoryBound(to: <span class="type">Double</span>.<span class="keyword">self</span>).pointee = <span class="number">2.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>unsafeBitCast</p>
<p>æ–¹æ³•åŸå‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">unsafeBitCast</span>&lt;T, U&gt;<span class="params">(<span class="number">_</span> x: T, to type: U.<span class="keyword">Type</span>)</span></span> -&gt; <span class="type">U</span></span><br></pre></td></tr></table></figure>

<p><code>unsafeBitCast</code>æ˜¯å¿½ç•¥æ•°æ®ç±»å‹çš„å¼ºåˆ¶è½¬æ¢ï¼Œä¸ä¼šå› ä¸ºæ•°æ®ç±»å‹çš„å˜åŒ–è€Œæ”¹å˜åŸæ¥çš„å†…å­˜æ•°æ®(ç±»ä¼¼äºC++ä¸­çš„reinterpret_cast)</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ptr1 : <span class="type">UnsafePointer</span>&lt;<span class="type">Int</span>&gt; = <span class="built_in">unsafeBitCast</span>(rawPtr, to: <span class="type">UnsafePointer</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="built_in">print</span>(ptr1.pointee) <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ptr2 : <span class="type">UnsafePointer</span>&lt;<span class="type">Double</span>&gt; = <span class="built_in">unsafeBitCast</span>(rawPtr + <span class="number">8</span>, to: <span class="type">UnsafePointer</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="built_in">print</span>(ptr2.pointee) <span class="comment">// 2.0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>unsafePointer</code> to <code>unsafeRawPointer</code></p>
<ul>
<li><p>ä½¿ç”¨<code>unsafeBitCast</code>æ–¹æ³•</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> pointerPtr = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int</span>&gt;.allocate(capacity: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rawptr = <span class="built_in">unsafeBitCast</span>(pointerPtr, to: <span class="type">UnsafeMutableRawPointer</span>.<span class="keyword">self</span>)</span><br><span class="line">rawptr.storeBytes(of: <span class="number">2.0</span>, <span class="keyword">as</span>: <span class="type">Double</span>.<span class="keyword">self</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pointerPtr.pointee) <span class="comment">//4611686018427387904</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨<code>UnsafeRawPointer</code>æˆ–è€…<code>UnsafeMutableRawPointer</code>çš„æ„é€ å‡½æ•°</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> pointerPtr = <span class="type">UnsafeMutablePointer</span>&lt;<span class="type">Int</span>&gt;.allocate(capacity: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rawptr = <span class="built_in">unsafeBitCast</span>(pointerPtr, to: <span class="type">UnsafeMutableRawPointer</span>.<span class="keyword">self</span>)</span><br><span class="line">rawptr.storeBytes(of: <span class="number">2.0</span>, <span class="keyword">as</span>: <span class="type">Double</span>.<span class="keyword">self</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pointerPtr.pointee) <span class="comment">//4611686018427387904</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> otherRawPointer = <span class="type">UnsafeRawPointer</span>(pointerPtr)</span><br><span class="line"><span class="built_in">print</span>(otherRawPointer.load(<span class="keyword">as</span>: <span class="type">Double</span>.<span class="keyword">self</span>)) <span class="comment">// 2.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> otherMutableRawPointer = <span class="type">UnsafeMutableRawPointer</span>(pointerPtr)</span><br><span class="line">otherMutableRawPointer.storeBytes(of: <span class="number">4</span>, <span class="keyword">as</span>: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="built_in">print</span>(pointerPtr.pointee) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Swift/" rel="tag"># Swift</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/10/18/Swift5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/" rel="prev" title="Swift5å­¦ä¹ ç¬”è®°ä¹‹è®¿é—®æ§åˆ¶">
      <i class="fa fa-chevron-left"></i> Swift5å­¦ä¹ ç¬”è®°ä¹‹è®¿é—®æ§åˆ¶
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/11/13/Swift5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/" rel="next" title="Swift5å­¦ä¹ ç¬”è®°ä¹‹æ¨¡å¼åŒ¹é…">
      Swift5å­¦ä¹ ç¬”è®°ä¹‹æ¨¡å¼åŒ¹é… <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">æ¦‚è¿°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#weak%E3%80%81unowned%E7%9A%84%E4%BD%BF%E7%94%A8%E9%99%90%E5%88%B6"><span class="nav-number">2.</span> <span class="nav-text">weakã€unownedçš„ä½¿ç”¨é™åˆ¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Autoreleasepool"><span class="nav-number">3.</span> <span class="nav-text">Autoreleasepool</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8-Reference-Cycle"><span class="nav-number">4.</span> <span class="nav-text">å¾ªç¯å¼•ç”¨(Reference Cycle)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AD%E5%8C%85%E7%9A%84%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8"><span class="nav-number">5.</span> <span class="nav-text">é—­åŒ…çš„å¾ªç¯å¼•ç”¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%83%E9%80%B8%E9%97%AD%E5%8C%85%E4%B8%8E%E9%9D%9E%E9%80%83%E9%80%B8%E9%97%AD%E5%8C%85"><span class="nav-number">6.</span> <span class="nav-text">é€ƒé€¸é—­åŒ…ä¸éé€ƒé€¸é—­åŒ…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%E5%86%B2%E7%AA%81"><span class="nav-number">7.</span> <span class="nav-text">å†…å­˜è®¿é—®å†²çª</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E9%92%88"><span class="nav-number">8.</span> <span class="nav-text">æŒ‡é’ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%8C%87%E9%92%88%E7%B1%BB%E5%9E%8B"><span class="nav-number">8.1.</span> <span class="nav-text">å¸¸è§çš„å››ç§æŒ‡é’ˆç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%BE%97%E6%8C%87%E5%90%91%E6%9F%90%E4%B8%AA%E5%8F%98%E9%87%8F%E7%9A%84%E6%8C%87%E9%92%88"><span class="nav-number">8.2.</span> <span class="nav-text">è·å¾—æŒ‡å‘æŸä¸ªå˜é‡çš„æŒ‡é’ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%8C%87%E5%90%91%E5%A0%86%E7%A9%BA%E9%97%B4%E5%AE%9E%E4%BE%8B%E7%9A%84%E6%8C%87%E9%92%88"><span class="nav-number">8.3.</span> <span class="nav-text">è·å–æŒ‡å‘å †ç©ºé—´å®ä¾‹çš„æŒ‡é’ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%8C%87%E9%92%88"><span class="nav-number">8.4.</span> <span class="nav-text">åˆ›å»ºæŒ‡é’ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="nav-number">8.4.1.</span> <span class="nav-text">ç¬¬ä¸€ç§æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="nav-number">8.4.2.</span> <span class="nav-text">ç¬¬äºŒç§æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="nav-number">8.4.3.</span> <span class="nav-text">ç¬¬ä¸‰ç§æ–¹å¼</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="nav-number">8.5.</span> <span class="nav-text">æŒ‡é’ˆä¹‹é—´çš„è½¬æ¢</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dev.Gao</p>
  <div class="site-description" itemprop="description">äººç±»çš„æœ¬èƒ½æ˜¯èƒ†æ€¯ï¼Œä½†äººç±»çš„æœ¬è´¨æ˜¯ä¸ç”˜å¿ƒ</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dev.Gao</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
